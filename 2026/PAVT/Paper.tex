\documentclass{cmi}
\usepackage{upgreek}

% Данные поля заполняются редакцией журнала
%\makeatletter
%\newcommand{\@volume}{}
%\newcommand{\@issue}{}
%\newcommand{\@num}{}
%\newcommand{\@pages}{}
%\usepackage[backend=biber,style=numeric,sorting=none]{biblatex}
\usepackage{subcaption}

\begin{document}.
\classify{УДК 123.456, 789.012}

\renewcommand*{\thefootnote}{\fnsymbol{footnote}} %to make a number in end of title delete this line

\title{ПАРАЛЛЕЛЬНЫЙ АЛГОРИТМ ГЛОБАЛЬНОЙ ОПТИМИЗАЦИИ И ЕГО ИСПОЛЬЗОВАНИЕ ДЛЯ РЕШЕНИЯ ОБРАТНЫХ ЗАДАЧ ХИМИЧЕСКОЙ КИНЕТИКИ
%\footnote{Если статья рекомендована к публикации программным комитетом научной конференции, это указывается в сноске к названию статьи. Благодарность за финансовую поддержку в подготовке статьи необходимо поместить после заключения.}%
}

\authors{К.А.~Баркалов$^{1,2}$, Е.Н.~Варсеева$^{1}$}

\organizations{
	$^{1}$Нижегородский государственный университет им. Н.И. Лобачевского	\\ (603022 Н.~Новгород, просп.~Гагарина, д.~23)\\
	$^{2}$Научно-образовательный математический центр <<Математика технологий будущего>> \\ (603022 Н.~Новгород, просп.~Гагарина, д.~23, корп.~2)
	}

\newcommand{\emailsinsert}{\href{mailto:konstantin.barkalov@itmm.unn.ru}{konstantin.barkalov@itmm.unn.ru}, \href{mailto:kate.varseeva@yandex.ru}{kate.varseeva@yandex.ru}}

% Дата поступления статьи в редакцию
\newcommand{\rdate}{ДД.ММ.ГГГГ}
\emails{\emailsinsert}
\redactiondate{\rdate}

\renewcommand*{\thefootnote}{\arabic{footnote}}
\setcounter{footnote}{0}

% оформление аннотации
\begin{abstract}%
В статье рассматривается использование параллельных вычислений для выбора параметров математической модели процесса низкотемпературной паровой конверсии углеводородов, входящих в состав попутного нефтяного газа. Для указанного химического процесса необходимо сформировать его кинетическую модель, то есть определить соответствующие кинетические параметры реакций. Для этого решается обратная задача, в которой ищутся значения кинетических параметров на основе экспериментальных данных. С математической точки зрения, обратная задача химической кинетики представляет собой задачу глобальной оптимизации. Для ее решения был использован параллельный информационно-статистический алгоритм глобального поиска в сочетании с локальным уточнением лучшего решения. Найденные оптимальные параметры модели позволили адекватно смоделировать процесс низкотемпературной паровой конверсии легких углеводородов с использованием катализатора.

\keywords{необходимо указать от 3 до 10 ключевых слов и (или) фраз через запятую.}
\end{abstract}

%Образец цитирования статьи
\forcitation{Баркалов~К.А., Варсеева~Е.Н. Параллельный алгоритм глобальной оптимизации и его использование для решения обратных задач химической кинетики}

%Верхние колонтитулы
\markboth{К.А.~Баркалов, Е.Н.~Варсеева}{Параллельный алгоритм глобальной оптимизации\ldots}

% Заголовки разделов формируются при помощи команд  \section{}, \subsection{}, \subsubsection{}
\section*{Введение}
\label{sec-intro}

В настоящее время сжигание попутного нефтяного газа (ПНГ) является актуальной проблемой российской нефтедобывающей промышленности. ПНГ представляет собой смесь предельных углеводородов, добываемых на нефтяных месторождениях. Одним из наиболее перспективных способов эффективной утилизации ПНГ является использование его непосредственно на месторождении для выработки электроэнергии и тепла на малых электростанциях для обеспечения собственных нужд месторождения~\cite{UskovPSSKS2019}. Использование исходного ПНГ в качестве топлива неприемлемо, поскольку он имеет высокое содержание $C_{2+}$-углеводородов, что может вызывать поломку двигателей внутреннего сгорания. Для решения этой проблемы предлагается использовать низкотемпературную паровую конверсию (НТПК) $C_{2+}$-углеводородов, входящих в состав ПНГ, с преимущественным образованием метан-водородных смесей~\cite{ZyryanovaSSBKS2014}, которые уже можно использовать в качестве топлива.

Для проведения НТПК $C_{2+}$-углеводородов были широко исследованы катализаторы на основе никеля~\cite{EnikeevaPUSSEG21,PotemkinUGKSB2020,ShigarovUP2022,UskovPSSKS2019}. Однако основной проблемой никелевых катализаторов остаётся их невысокая стабильность, связанная с зауглероживанием или спеканием никелевых частиц во время эксплуатации катализатора.

Сотрудники Института катализа СО РАН в своих работах показали, что родиевые катализаторы, нанесённые на смешанные оксиды церия-циркония, проявляют высокую активность и стабильность в процессе НТПК пропана~\cite{UrlukovUSP22:ru,UrlukovUSBRRS23:ru,GarkulZFBBP2024,UrlukovUSSP2022,ZadesenetsGFSPP2023}, а катализатор 1~вес.\,\%~Rh/Ce$_{0.4}$Zr$_{0.5}$Y$_{0.05}$La$_{0.05}$O$_2$ является перспективным вариантом среди других родий-содержащих аналогов~\cite{UrlukovUSBRRS23:ru}.
Однако для более детального понимания кинетики процесса НТПК углеводородов на Rh катализаторах и оптимизации условий его проведения нужно построить и проанализировать математическую модель указанного процесса (так называемую кинетическую модель).

%Кинетическая модель является основой математического моделирования химических реакций и исходным уровнем при математическом моделировании химических реакторов. 
При разработке кинетической модели многостадийной химической реакции требуется решить обратную задачу химической кинетики, при решении которой на основе экспериментальных данных о динамике протекания процесса определеляются количественные характеристики кинетической модели --- константы скоростей одностадийных реакций. С математической точки зрения обратная задача химической кинетики представляет собой задачу глобальной оптимизации, поэтому важно выбрать подходящий для ее решения метод.

%Связку взять из статьи с RSD
Метод решения оптимизационных задач подобного типа должен учитывать следующую специфику. Во-первых, целевая функция задачи представляет собой <<чёрный ящик>>, поскольку она задаётся не аналитической формулой, а в виде алгоритма, вычисляющего её значения. Во-вторых, даже однократное вычисление значения целевой функции является трудоёмкой операцией, так как требует выполнения численного моделирования.

Указанная специфика исключает возможность применения для решения обратных задач мультистартовых методов, основанных на многократном использовании градиентного спуска. С одной стороны, вычисление градиента в данном случае оказывается чрезмерно дорогостоящим, а с другой --- мультистартовые подходы слабо применимы к существенно многоэкстремальным задачам, каковыми и являются обратные задачи химической кинетики.

Перечисленные особенности обратных задач учитываются в разработанном в Нижегородском университете параллельном алгоритме глобальной оптимизации. Теоретической основой данного алгоритма служит информационно-статистический подход, подробно изложенный в \cite{Strongin2000}. Суть алгоритма заключается в редукции исходной многомерной задачи к эквивалентной одномерной задаче, которая затем решается эффективными методами оптимизации функций одной переменной. Вопросы распараллеливания предложенного алгоритма на различных архитектурах рассматриваются в \cite{Barkalov2016}.

%Структура статьи
В настоящей статье представлены результаты применения параллельного алгоритма глобального поиска к решению обратной задачи химической кинетики. Статья имеет следующую структуру. 
В разделе \ref{sec-problem} приведено описание математической модели изучаемой химической реакции, сформулирована обратная задача.
В разделе \ref{sec-PGSA} излагается стандартная постановка задачи глобальной оптимизации, приведена вычислительная схема параллельного алгоритма ее решения, сформулированы его теоретические свойства, кратко рассмотрены вопросы, связанные с техническими аспектами реализации параллельного алгоритма.
Содержательная интерпретация результатов численных расчетов с использованием разработанного параллельного алгоритма представлена в разделе \ref{sec-result}.
В последнем разделе содержатся выводы и планы дальнейших исследований.

\section{Постановка задачи}
\label{sec-problem}

Для описания НТПК пропана достаточно учесть следующие реакции.

\begin{equation}\label{eq1}
\begin{array}{l}
\displaystyle C_{3}H_{8} + 6H_{2}O \rightarrow 3CO_{2} + 10H_{2}, \\
\displaystyle C_{3}H_{8} + H_{2} \rightarrow C_{2}H_{6} + CH_{4}, \\
\displaystyle C_{2}H_{6} + H_{2} \rightarrow 2CH_{4}, \\
\displaystyle CO_{2} + 4H_{2} \rightleftharpoons CH_{4} + 2H_{2}O. \\
\end{array}
\end{equation}

Было проведено математическое моделирование НТПК этана и пропана на 1~вес.\,\%~Rh/Ce$_{0.4}$Zr$_{0.5}$Y$_{0.05}$La$_{0.05}$O$_{2}$ катализаторе с использованием реакций~(1) и механизма Ленгмюра--Хиншельвуда для задания скоростей некоторых реакций~\cite{ArcotumapathyAAVAA2015,BatebiAM2021}:
\begin{equation}
\begin{cases}
\displaystyle w_{1} = k_{1} \cdot \frac{p_{C_{3}H_{8}}\cdot p_{H_{2}O}}{(p_{H_{2}O}+\alpha\cdot\sqrt{p_{H_{2}}})^2}, \\
\displaystyle w_{2} = k_{2} \cdot p_{C_{3}H_{8}} \cdot p_{H_{2}}, \\
\displaystyle w_{3} = k_{4}\cdot \frac{\sqrt{p_{H_{2}}}\cdot p_{C_{2}H_{6}}}{(p_{H_{2}O}+\alpha\cdot\sqrt{p_{H_{2}}})^2},\\
\displaystyle w_{4} = k_{4}\cdot p_{CO_{2}}\cdot p_{H_{2}}-k_{-4}\cdot p_{H_{2}O}\cdot p_{CH_{4}},\\
\end{cases}
\end{equation}
где \textit{p}$_{X}$ --- парциальное давление вещества $X$, атм.; \textit{w}$_{i}$ --- скорость $i$-ой реакции, атм./(л.$\cdot$с.); $k_{i}$ --- константа скорости $i$-ой реакции; $t$ --- время, с.; $\alpha$ --- отношение констант адсорбции $H_{2}$ и $H_{2}O$ на выбранном катализаторе.

Система дифференциальных уравнений для описания кинетики НТПК пропана:
\begin{equation}
\begin{cases}
\displaystyle u\cdot \frac{dp_{C_{3}H_{8}}}{dl} = -w_{1}-w_{2},\\
\displaystyle u\cdot \frac{dp_{H_{2}O}}{dl} = -6w_{1}+2w_{4},\\
\displaystyle u\cdot \frac{dp_{CO_{2}}}{dl} = 3w_{1}-w_{4},\\
\displaystyle u\cdot \frac{dp_{H_{2}}}{dl} = 10w_{1}-w_{2}-w_{3}-4w_{4},\\
\displaystyle u\cdot \frac{dp_{CH_{4}}}{dl} = w_{2}+2w_{3}+w_{4},\\
\displaystyle u\cdot \frac{dp_{C_{2}H_{6}}}{dl} = w_{2}-w_{3},\\
\end{cases}
\end{equation}
где $u$ --- линейная скорость потока реакционной смеси, м./с., $l$ --- координата длины реактора, м.

Прямая задача химической кинетики представляет собой расчёт состава многокомпонентной реагирующей смеси на основе кинетической модели с известными параметрами~\cite{MazitovOAG16:ru}.
Математически прямая задача представляет собой задачу Коши для системы из $n$ уравнений:
\begin{equation}
x'=f(x), x(t_{0}) = x_{0}, t\in[t_{0},t_{k}],
\end{equation}
где $x_{0}$, $x$ --- вещественные $n$-мерные функции, $t$ --- независимая переменная, которая изменяется на заданном интервале $[t_{0},t_{k}]$.

Начальными данными в прямой задаче являются начальное и конечное значения $t_{0}$ и $t_{k}$, а также исходные концентрации реагентов $x_{0}$.

Решением прямой задачи является пара чисел $(t_i,\ \mathbf{x}_i)$, где $t_i$~-- момент времени, а $\mathbf{x}_i$ --- вектор концентраций всех реагентов системы в данный момент времени~\cite{MazitovOAG16:ru}.

Для решения прямой задачи при различных температурах реакции был реализован модифицированный метод Рунге-Кутты 4 порядка точности по следующим формулам:

\begin{equation}
\begin{array}{l}
F_{1}=f(x_{k})\cdot h,\\
F_{2}=f(x_{k}+F_{1}/3)\cdot h,\\
F_{3}=f(x_{k}+(F_{1}+F_{2})/6)\cdot h,\\
F_{4}=f(x_{k}+(F_{1}+3 \cdot F_{3})/8)\cdot h,\\
x_{k+1}=x_{k} + (F_{1}-3 \cdot F_{3} + 4 \cdot F_{4})/ 2,\\
F_{5}=f(x_{k+1})\cdot h,\\
x^*_{k+1}=x_{k} + (F_{1}+4 \cdot F_{4} + F_{5})/ 6.\\
\end{array}
\end{equation}

Построение математических моделей химических реакций предполагает наличие в них неизвестных кинетических параметров (предэкспоненциальные множители констант скоростей, энергии активации, наблюдаемые порядки по компонентам), которые можно найти, решая задачу минимизации отклонения между расчётными и экспериментальными данными. Таким образом, возникает задача идентификации математической модели (обратная задача химической кинетики)~\cite{GubaidullinRT11:ru,MorlanesLYMC2022,WooPBP2023}.

Решение обратной задачи химической кинетики сводится к поиску минимума целевой функции~\cite{MazitovOAG16:ru}. В данной работе в качестве критерия минимизации выбрана целевая функция следующего вида:
\begin{equation}\label{eq6}
E=\sum_{i=1}^n \left|p_{i}^{exp_k}-p_{i}^{calc_k}\right|\cdot v_{i},
\end{equation}
где $p_{i}^{exp_k}$, $p_{i}^{calc_k}$ --- экспериментальные и расчётные значения давлений веществ; $v_{i}$ --- весовые коэффициенты; $n$ --- количество измеряемых веществ.

Требуется найти набор констант скоростей $k$, при котором значение функции (\ref{eq6}) минимально.

%Содержательная постановка задачи. Математическая модель в виде системы ОДУ. Метод решения ОДУ, его свойства. Задача идентификации параметров реакции.

\section{Параллельный алгоритм решения задач глобальной оптимизации} \label{sec-PGSA}
\subsection{Задача глобальной оптимизации}

Рассмотрим задачу глобальной оптимизации вида 
\begin{gather}
 \varphi(y^\ast)=\min{\left\{\varphi(y):y\in D\right\}}, \label{problem}\\
 D=\left\{y\in \mathbb{R}^N: a_i\leq y_i \leq b_i, \; a_i,b_i\in \mathbb{R}, \;  1\leq i \leq N\right\} \label{D},
\end{gather}
где целевая функция является <<чёрным ящиком>> и предполагается удовлетворяющей условию Липшица
\[
\left|\varphi(y_1)-\varphi(y_2)\right|\leq L\left\|y_1-y_2\right\|,\; y_1,y_2 \in D,
\]
с константой $L, \; L<\infty,$ неизвестной априори.

Предположение о липшицевости целевой функции типично для многих подходов к построению детерминированных алгоритмов глобальной оптимизации.
Первые методы липшицевой оптимизации были предложены в начале 1970-х годов \cite{Piyavskii1972,Shubert1972}. С тех пор это направление активно развивается \cite{Evtushenko2013,Zilinskas2010,Pinter1996,Jones2009}.

В настоящее время для решения задач с целевой функцией вида <<черный ящик>> широко применяются биоинспирированные метаэвристические алгоритмы; см., например, \cite{Yang2013,Gendreau2010,Eiben2015}. Такие алгоритмы так или иначе используют идеи случайного поиска. Благодаря простоте реализации и применения они получили широкое распространение. Однако по качеству работы (например, по количеству корректно решённых задач из заданного класса) эти алгоритмы уступают детерминированным аналогам \cite{Kvasov2018,Sergeyev2018}.

Одним из эффективных детерминированных методов решения задач многоэкстремальной оптимизации является \textit{информационно-статистический алгоритм глобального поиска} \cite{Strongin2000}. Первоначально предложенный для задач без ограничений, он был успешно обобщён на классы задач с невыпуклыми ограничениями и многокритериальной оптимизации. Для различных версий алгоритма также были предложены методы распараллеливания, учитывающие архитектуру современных вычислительных систем \cite{Barkalov2016,globalizerSystem,Strongin2018}.

Многие современные алгоритмы глобальной оптимизации используют идею редукции размерности при решении многомерных задач; см., например, метод диагональных разбиений \cite{Sergeyev2006} или метод симплексных разбиений \cite{Zilinskas2008}. Параллельный алгоритм глобального поиска, описываемый в данном разделе, использует кривые Пеано \cite{Sergeyev2013,Strongin2000}, непрерывно и однозначно отображающие единичный отрезок $[0,1]$ на $N$-мерный куб $D$ из (\ref{D}). С помощью такого отображения исходная многомерная задача (\ref{problem}) сводится к одномерной задаче
\[
\varphi(y^\ast)=\varphi(y(x^\ast))=\min{\left\{\varphi(y(x)): x\in[0,1]\right\}},
\]
где функция $\varphi(y(x))$ удовлетворяет равномерному условию Гёльдера
\[
\left|\varphi(y(x_1))-\varphi(y(x_2))\right|\leq H\left|x_1-x_2\right|^{1/N}
\]
с константой Гёльдера $H$, связанной с константой Липшица $L$ соотношением
$ H=2 L \sqrt{N+3}$, где $y(x)$ --- кривая Пеано, отображающая $[0,1]$ на $D$.

%комментарий про гельдеовскую функцию f(x)

Отметим, что теоретически кривая Пеано $y(x)$ определяется как предельный объект. Поэтому при практической реализации может быть построена лишь некоторая аппроксимация истинной заполняющей пространство кривой. Некоторые методы построения таких аппроксимаций (называемых \textit{развертками}) рассматриваются в \cite{Sergeyev2013,Strongin2000}. В данном случае точность аппроксимации истинной кривой $y(x)$ зависит от плотности развертки $m$ (которая является параметром ее построения) и имеет порядок $2^{-m}$ по каждой координате.
Примеры разверток при размерности $N=3$ и различных значениях $m$ показаны на рис.~\ref{evolvents}.

\begin{figure}[ht]
\begin{minipage}{0.48\linewidth}
\center{\includegraphics[width=1.0\linewidth]{fig1a.JPG} \\ (a)}
\end{minipage}
\begin{minipage}{0.48\linewidth}
\center{\includegraphics[width=1.0\linewidth]{fig1b.JPG} \\ (b)}
\end{minipage}
\caption{Развертки в трёхмерном пространстве при (a) $m=3$ и (b) $m=4$}
\label{evolvents}
\end{figure}

\subsection{Параллельный алгоритм глобального поиска}

Будем называть процесс вычисления значения функции (включая построение образа $y=y(x)$) \textit{испытанием}, а пару $\{x, z = \varphi(y(x))\}$ --- результатом испытания.
При описании параллельного алгоритма будем использовать термин \textit{итерация} для обозначения одновременного (параллельного) выполнения нескольких испытаний (каждое испытание выполняется в отдельном потоке или процессе). Число испытаний на $n$-й итерации обозначим $p$, а общее число испытаний, выполненных за все $n$ итераций, обозначим $k(n)$. Иными словами, предполагается, что при выполнении $n$-й итерации имеется в распоряжении $p$ процессов.

Параллельный алгоритм глобального поиска, используемый в настоящем исследовании (согласно \cite{Strongin2000}), формулируется следующим образом.
Первые $p$ испытаний выполняются в точках $x^0 = 0$, $x^1 = 1$ и в произвольных внутренних точках $x^2, ..., x^{p-1}$ интервала $(0,1)$. Предположим, что завершено $n \geq 1$ итераций метода, в ходе которых проведены испытания в $k=k(n)$ точках $x^i, 0 \leq i \leq k$. Тогда точки $x^{k+1},...,x^{k+p}$ для проведения испытаний на следующей $(n+1)$-й итерации определяются согласно следующим правилам. 

\begin{enumerate}
	\item 
	Перенумеровать прообразы всех точек, в которых уже проведены испытания,  
\begin{equation}\label{y_i}
y^0=y(x^0), y^1=y(x^1),...,y^k=y(x^k)
\end{equation}
по возрастанию их координат, то есть
\begin{equation}\label{x_i}
0=x_0<x_1<\dots <x_k=1,
\end{equation}
и сопоставить им вычисленные значения $z_i=\varphi(y(x_i)), 0\leq i \leq k$.

\item
Вычислить максимальное абсолютное значение разделенных разностей
\begin{equation}\label{mu}
\mu = \max_{1 \leq i \leq k}\frac{\left|z_i-z_{i-1}\right|}{\Delta_i},
\end{equation}
где $\Delta_i=\left(x_i-x_{i-1}\right)^{1/N}$. Если $\mu = 0$, полагаем $\mu = 1$.

\item
Для каждого интервала $(x_{i-1}, x_i), \; 1\leq i \leq k,$ вычислить величину
\begin{equation}\label{R}
R(i)=r\mu\Delta_i+\frac{(z_i-z_{i-1})^2}{r\mu\Delta_i}-2(z_i+z_{i-1})
\end{equation}
называемую \textit{характеристикой} интервала; вещественное число $r>1$ является параметром алгоритма.

\item 
Упорядочить характеристики $R(i), 1 \leq i \leq k$, по убыванию 
\begin{equation}\label{Rdec}
R(t_1)\geq R(t_2)\geq \dots \geq R(t_{k})
\end{equation}
и выберем $p$ наибольших характеристик с номерами интервалов $t_j, 1\leq j \leq p$.

\item
Провести новые испытания в точках $x^{k+j}\in(x_{t_j-1},x_{t_j}), 1\leq j\leq p$, вычисляемых по формуле
\[
x^{k+j} = \frac{x_{t_j}+x_{t_j-1}}{2} - \mathrm{sign}(z_{t_j}-z_{t_j-1})\frac{1}{2r}\left[\frac{\left|z_{t_j}-z_{t_j-1}\right|}{\mu}\right]^N.
\]

\end{enumerate}

Алгоритм прекращает свою работу, если хотя бы для одного индекса $t_j, 1 \leq j \leq p,$ выполняется условие $\Delta_{t_j}<\epsilon$; здесь $\epsilon>0$ --- заданная точность. Алгоритм также останавливается, если исчерпано максимально допустимое число испытаний $K_{max}$, установленное до начала вычислений.

%Теоретические сведения о распараллеливании
Введение описанного выше параллелизма не приводит к возникновению новых предельных точек, отличных от предельных точек последовательного алгоритма, т.е. когда $p = 1$. Условия сходимости для параллельного АГП могут быть сформулированы в виде следующей теоремы. 

\begin{theorem*}%
	Пусть $\overline{x}$ есть предельная точка последовательности испытаний $\{x^k\}$, порождаемой ПАГП при минимизации функции $f(x), x\in [0,1],$ удовлетворяющей условию Гельдера с константой $H, 0<H<\infty$; причем число задействованных вычислительных элементов $p, 1<p<\infty,$ является фиксированным, а в условии остановки $\epsilon = 0$. Тогда:
	
	\begin{enumerate}
		\item
		сходимость к внутренней точке $\overline{x} \in (0,1) $ является двусторонней;
		\item
		точка $\overline{x}$ локально оптимальна, если функция $f(x)$ имеет конечное число локальных экстремумов;
		\item
		если наряду с $\overline{x}$ существует другая предельная точка $\widehat{x}$, то $f(\overline{x})=f(\widehat{x})$;
		\item
		при любом $k>1$ выполняется неравенство $f(x_k) \geq f(\overline{x})$;
		\item
		если на некотором шаге для величины $r\mu$ из (\ref{R}) выполняется условие $r\mu > 2^{2-1/N}H$;
	\end{enumerate}
	то множество предельных точек последовательности $\{x^k\}$ совпадает с множеством точек глобального минимума $f(x)$.
\end{theorem*}
\begin{proof}%
	Доказательство теоремы приведено в работе \cite{Strongin2000}.
\end{proof}

%Комментарий о распараллеливании
Рассматриваемый вариант распараллеливания является \textit{синхронным}, когда переход к следующей итерации осуществляется только после полного завершения текущей, то есть после окончания последнего испытания текущей итерации. 

Конкретная реализация этой схемы распараллеливания будет зависеть от архитектуры компьютерной системы, а также от требований к программному обеспечению, необходимому для вычисления значений целевой функции. В настоящем исследовании для проведения испытаний требовалось решить систему ОДУ (для решения этой задачи использовался модифицированный методы Рунге-Кутты 4-го порядка). Распараллеливание было организовано с использованием общей памяти и схемы мастер-рабочие. Алгоритм глобального поиска был запущен в потоке-мастере, остальные (подчиненные) потоки проводили параллельные испытания в рамках шага 5 алгоритма. При этом время проведения одного испытания составляло порядка 0.1 секунды, таким образом, накладные расходы на синхронизацию между потоками не оказывали существенного влияния на эффективность распараллеливания.

%Комментарий о локальном уточнении
После определения с помощью паралельного АГП точки, являющейся грубой оценкой глобального минимума, из нее запускается локальный метод. Мы использовали метод Хука--Дживса, который относится к классу методов нулевого порядка. Его правила вычисления представляют собой комбинацию исследовательского поиска (для выбора направления) и последующего поиска в выбранном направлении \cite{Himmelblau75}.

Исследующий поиск определяется следующим образом: 
\begin{itemize} 
  \item Вначале определяется величина шага: она является различной для каждого координатного направления и может изменяться во время поиска. 
  \item Шаг поиска считается успешным, если значение целевой функции в новой точке не превышает значение целевой функции в исходной точке. 
  \item Если шаг является неуспешным, то нужно вернуться к исходной точке и сделать шаг в обратном направлении. 
  \item После перебора всех $N$ координатных направлений исследовательский поиск завершается; полученная точка является базовой точкой для поиска по образцу.
\end{itemize}

Поиск по образцу состоит из выполнения одного шага от полученной базовой точки вдоль линии, соединяющей ее с предыдущей базовой точкой.

Рис. \ref{fig:fig1} иллюстрирует работу локального алгоритма. Показаны линии уровня целевой функции; темные точки соответствуют успешным, а светлые -- неуспешным шагам, проведенным в ходе исследовательского поиска.

\begin{figure} 
	\begin{center} 
			\includegraphics[width=0.8\linewidth]{pic/fig1.pdf} 
			\caption{Иллюстрация работы метода Хука-Дживса} %%  подпись к рисунку 
			\label{fig:fig1} 
	\end{center} 
\end{figure}	



\section{Результаты численных экспериментов}
\label{sec-result}

Вычислительные эксперименты проводились на узле суперкомпьютера <<Лобачевский>> в следующей конфигурации: операционная система Linux CentOS 8.2, 2 процессора Intel Xeon Platinum 8558 2.1/4GHz (48 ядер каждый), оперативная память 2048 Gb. 
Все рассмотренные алгоритмы реализованы на С++, использовался компилятор Intel С++ Сompiler 2023 с поддержкой OpenMP.

Выбор оптимальных кинетических параметров осуществлялся следующим образом. Были получены экспериментальные данные для 18 различных температур проведения реакции. Далее, для каждой из этих температур решалась обратная задача и выбирались константы скоростей реакций, минимизирующие функцию (\ref{eq6}) отклонения расчётных концентраций от экспериментальных для каждой температуры. Далее предэкспоненциальный множитель и энергии активации, входящие в уравнения линейно, искались с помощью метода наименьших квадратов.

Таким образом, с помощью параллельного АГП было решено 18 обратных задач, каждая для своей температуры.
Параллельный алгоритм запускался со следующими параметрами: плотность построения развертки $m=10$, параметр надежности $r=1.5$, точность глобального поиска $\epsilon = 10^{-2}$, локального уточнения $\delta = 10^{-4}$; максимальное число итераций глобального поиска $K_{max}^{glob} = 64 000$, локального поиска $K_{max}^{loc} = 500$. Число потоков варьировалось от 1 до 128.
В табл.~\ref{tab:scalability} приведены усредненные (по всем 18 задачам) оценки времени работы и ускорения параллельного алгоритма.  

\begin{table}[h]
\noindent
\caption{Зависимость времени решения и ускорения от числа потоков}
\label{tab:scalability}
\centering
\begin{tabular}{|c|c|c|}
\hline
\textbf{P} & \textbf{Время решения, с} & \textbf{Ускорение} \\
\hline
1   & 1170.00  & --- \\
2   & 600.27  & 1.95 \\
4   & 308.34  & 3.79 \\
8   & 162.82  & 7.19 \\
16  & 87.95   & 13.30 \\
32  & 54.43   & 21.50 \\
64  & 47.90   & 24.42 \\
128 & 51.64   & 22.65 \\
\hline
\end{tabular}
\end{table}

С помощью алгоритма глобального поиска для каждой температуры были получены наборы констант скоростей, минимизирующие функцию отклонения расчётных концентраций от экспериментальных (\ref{eq6}) для каждой температуры. Довески из формулы (\ref{eq6}) были подобраны экспериментально: \{1., 1., 1., 1., 1., 4.4\}.

После того, как с помощью параллельного АГП были получены наборы констант скоростей для каждой температуры, осуществлялся поиск предэкспоненциального множителя $k_0$ и энергии активации $E_a$ (Дж/моль). Для этого метод наименьших квадратов применялся к соотношению, полученному логарифмированием уравнения Аррениуса:
\begin{equation}
\ln (k)=\ln (k_0) - \frac{E_a}{RT},
\end{equation}
где $R$ --- универсальная газовая постоянная, Дж/(моль $\cdot$ K); $T$ --- температура, $K$.

Здесь в качестве $k$ подставляются полученные параллельным алгоритмом глобального поиска значения констант скоростей, соответствующие различным температурам $T$.

Далее методом наименьших квадратов были рассчитаны значения для $k_0$ и $E_a$ для всех стадий. Полученные значения приведены в табл.~\ref{tab:kinetik}.

\begin{table}[h]
\noindent
\caption{Рассчитанные кинетические параметры реакций (\ref{eq1})}
\label{tab:kinetik}
\centering
\begin{tabular}{|c|c|c|}
\hline
\textbf{№ реакции} & \textbf{$ln(k_0)$} & \textbf{$E_a$, кДж/моль} \\
\hline
1   & 15.09  & 73.28 \\
2   & 4.65   & 7.51 \\
3   & 3.19   & 8.88 \\
4   & 4.28   & 5.87 \\
4'  & 10.6   & 57.31 \\
\hline
\end{tabular}
\end{table}

Далее расчётные концентрации были пересчитаны с учётом $k_0$ и $E_a$, полученных методом наименьших квадратов. Полученные расчётные концентрации для разных температур были сопоставлены с экспериментальными концентрациями.

На рис.~\ref{fig:result} представлены графики зависимости экспериментальных и расчётных концентраций от температуры для $C_3H_8$, $H_2O$, $CO_2$, $H_2$, $CH_4$, $C_2H_6$. 
Экспериментальные данные обозначены синим цветом, а расчётные --- оранжевым. Показано, что модель соответствует эксперименту и может использоваться для прогнозирования состава продуктов паровой конверсии углеводородов.

\begin{figure}[ht]
    \centering 
    \begin{subfigure}[b]{0.45\linewidth}
        \centering
        \includegraphics[width=\linewidth]{C3H8.jpg}
        \caption{C$_3$H$_8$}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\linewidth}
        \centering
        \includegraphics[width=\linewidth]{H2O.jpg}
        \caption{H$_2$O}
    \end{subfigure}

    \begin{subfigure}[b]{0.45\linewidth}
        \centering
        \includegraphics[width=\linewidth]{CO2.jpg}
        \caption{CO$_2$}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\linewidth}
        \centering
        \includegraphics[width=\linewidth]{H2.jpg}
        \caption{H$_2$}
    \end{subfigure}

    \begin{subfigure}[b]{0.45\linewidth}
        \centering
        \includegraphics[width=\linewidth]{CH4.jpg}
        \caption{CH$_4$}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\linewidth}
        \centering
        \includegraphics[width=\linewidth]{C2H6.jpg}
        \caption{C$_2$H$_6$}
    \end{subfigure}
    \caption{Сопоставление экспериментальных и расчётных концентраций}\label{fig:result}
\end{figure}



\section*{Заключение}
\label{sec-conclusion}

В планы дальнейших работ входит также использование других схем распараллеливания, способных повысить эффективность использования параллельных вычислительных систем для решения задач глобальной оптимизации. Сложности с достижением значительных показателей ускорения объясняются следующими двумя обстоятельствами. 

Во-первых, при реализации параллельного алгоритма была применена синхронная схема распараллеливания. Управляющий поток-мастер (в котором работал метод оптимизации) при выполнении  шага 5 алгоритма ожидал окончания проведения всех испытаний, проводимых рабочими потоками. В решаемой задаче время проведения одного испытания зависит от времени решения системы ОДУ и может варьироваться в зависимости от конкретных значений параметров. Возможный путь к повышению эффективности распараллеливания --- реализация асинхронной схемы проведения испытаний на шаге 5 алгоритма. В этом случае результаты испытания, полученные одним из вычислителей, могут быть отправлены для обработки мастеру немедленно, без ожидания окончания других испытаний. После чего вычислитель получает от мастера новую точку, в которой начнет проведение очередного испытания. Асинхронная схема распараллеливания, теоретически, способна обеспечить полную загрузку задействованных вычислительных ресурсов даже в том случае, когда время выполнения испытаний различно в разных точках области поиска.
 
Во-вторых, при масштабном распараллеливании <<узким местом>> становится локальный поиск, который выполняется для уточнения решения после завершения фазы глобального поиска. Локальный поиск требует незначительного (по сравнению с глобальным) числа поисковых испытаний, но эти испытания выполняются последовательно. И при параллельном запуске это незначительное число последовательных испытаний становится сопоставимым с числом параллельных итераций глобального поиска. В дальнейшем планируется использовать параллельную реализацию метода локального поиска на завершающем этапе работы, что способно повысить эффективность распараллеливания в целом.

Наконец, планируется развитие математических основ используемых алгоритмов параллельной глобальной оптимизации. 
В задаче поиска параметров модели, обеспечивающих минимум невязки между расчетными и экспериментальными данными, теоретическое значение целевой функции в точке глобального минимума является известным --- оно равно нулю.
При этом точка глобального минимума (соответствующая лучшим значениям параметров модели) является неизвестной и подлежит определению.
На практике нулевое значение невязки может и не достигаться, если исследуемая модель плохо соответствует эксперименту, но в таком случае целевая функция будет положительной.  
Информацию о нижней границе значений целевой функции можно использовать для разработки нового алгоритма оптимизации, который позволит как гарантировать сходимость к глобальному минимуму, так и ускорить процесс его отыскания.

\vspace{1em}
{\it Работа выполнена при финансовой поддержке Министерства образования и науки Российской Федерации, проект № FSWR-2026-0007.}


\begin{biblio}

\bibitem{GubaidullinRT11:ru}
Губайдуллин~И.М., Рябов~В.В., Тихонова~М.В. Применение индексного метода глобальной оптимизации при решении обратных задач химической кинетики // Вычислительные методы и программирование. 2011. Т.~12, №~1. С.~137--145.

\bibitem{MazitovOAG16:ru}
Мазитов~А.А., Осипова~А.Г., Ахметов~И.В., Губайдуллин~И.М. Решение обратной задачи химической кинетики на примере реакции синтеза бензилиденбензиламина // Журнал Средневолжского математического общества. 2016. Т.~18, №~3. С.~145--152.

\bibitem{UrlukovUSP22:ru}
Урлуков~А.С., Усков~С.И., Потемкин~Д.И., Снытников~П.В. Каталитическая конверсия факельного газа на Rh-катализаторах с последующей прямой монетизацией // Катализ в промышленности. 2022. Т.~22, №~4. С.~51--57.

\bibitem{UrlukovUSBRRS23:ru}
Урлуков~А.С., Усков~С.И., Потемкин~Д.И., Бердюгин~С.Н., Рогожников~В.Н., Снытников~П.В. Оптимизация состава Rh-содержащих катализаторов для применения в низкотемпературной паровой конверсии легких углеводородов // Экология и промышленность России. 2023. Т.~27, №~6. С.~17--23.

\end{biblio}

% Сведения об авторах (Ф.И.О.(полностью), степень, звание, кафедра (отдел), вуз, e-mail)
Баркалов Константин Александрович, д.т.н., доцент, кафедра математического обеспечения и суперкомпьютерных технологий, Нижегородский государственный университет им. Н.И. Лобачевского (Н. Новгород, Российская Федерация)

Варсеева Екатерина Николаевна, кафедра математического обеспечения и суперкомпьютерных технологий, Нижегородский государственный университет им. Н.И. Лобачевского (Н. Новгород, Российская Федерация)

%\newpage
{\phantom{eee} \hrule \vskip 4 pt}
\classify{} % Код MSC не нужен
%\classify{MSC 00000} % Коды MSC см. http://www.ams.org/msc/

\title{PARALLEL ALGORITHM OF GLOBAL OPTIMIZATION AND ITS USE FOR SOLVING INVERSE PROBLEMS OF CHEMICAL KINETICS}

\authorsen{K.A.~Barkalov$^{1,2}$, E.N.~Varseeva$^{1}$}

\organizations{
$^{1}$South Ural State University (pr. Lenina 76, Chelyabinsk, 454080 Russia),\\
$^{2}$Lomonosov Moscow State Universisty (GSP-1, Leninskie Gory 1, Moscow, 119991 Russia)
}

\emails{\emailsinsert}
\redactiondateen{\rdate}

\begin{abstract}%
The article discusses the use of parallel computing for selecting parameters of a mathematical model of low-temperature steam conversion process of hydrocarbons contained in associated petroleum gas. For this chemical process, it is necessary to develop its kinetic model, i.e., determine the corresponding kinetic reaction parameters. To achieve this, an inverse problem is solved where values of kinetic parameters are sought based on experimental data. Mathematically, the inverse problem of chemical kinetics corresponds to a global optimization problem. A parallel information-statistical algorithm for global search combined with local refinement of the best solution was used to solve this problem. The found optimal model parameters allowed adequately simulating the process of low-temperature steam conversion of light hydrocarbons using a catalyst.

\keywordsen{from 3 to 10 key words and (or) phrases separated by commas should be specified here.}
\end{abstract}

\forcitationen{Barkalov~K.A., Varseeva~E.N. Parallel algorithm of global optimization and its use for solving inverse problems of chemical kinetics}

\openaccess



% =============== СПИСОК "REFERENCES" (английская часть) ===============

\begin{biblio_lat}

\bibitem{ArcotumapathyAAVAA2015}
Arcotumapathy~V., Alenazey~F.S., Al-Otaibi~R.L., Vo~D.V.N., Alotaibi~F.M., Adesina~A.A. Mechanistic investigation of methane steam reforming over Ce-promoted Ni/SBA-15 catalyst // Applied Petrochemical Research. 2015. Vol.~5, No.~4. P.~393--404.

\bibitem{BatebiAM2021}
Batebi~D., Abedini~R., Mosayebi~A. Kinetic modeling of combined steam and CO$_2$ reforming of methane over the Ni--Pd/Al$_2$O$_3$ catalyst using Langmuir--Hinshelwood and Langmuir--Freundlich isotherms // Industrial \& Engineering Chemistry Research. 2021. Vol.~60, No.~2. P.~851--863.

\bibitem{EnikeevaPUSSEG21}
Enikeeva~L.V., Potemkin~D.I., Uskov~S.I., Snytnikov~P.V., Enikeev~M.R., Gubaydullin~I.M. Gravitational search algorithm for determining the optimal kinetic parameters of propane pre-reforming reaction // Reaction Kinetics, Mechanisms and Catalysis. 2021. Vol.~132. P.~111--122.

\bibitem{GarkulZFBBP2024}
Garkul~I.A., Zadesenets~A.V., Filatov~E.Y., Baidina~I.A., Plyusnin~P.E., Urlukov~A.S. et al. Double oxalates of Rh(III) with Cu(II) and Zn(II)--Effective precursors of nanoalloys for hydrogen production by steam reforming of propane // International Journal of Hydrogen Energy. 2024. Vol.~82. P.~611--623.

\bibitem{Barkalov2016}
Barkalov~K., Lebedev~I. Solving multidimensional global optimization problems using graphics accelerators // Communications in Computer and Information Science. 2016. Vol.~687. P.~224--235. DOI:~\href{http://dx.doi.org/10.1007/978-3-319-45507-7_19}{10.1007/978-3-319-45507-7\_19}

\bibitem{GubaidullinRT11}
Gubaidullin~I.M., Ryabov~V.V., Tikhonova~M.V. Application of the index method of global optimization for solving inverse problems of chemical kinetics // Computational Methods and Programming. 2011. Vol.~12, No.~1. P.~137--145. (in Russian)

\bibitem{MazitovOAG16}
Mazitov~A.A., Osipova~A.G., Akhmetov~I.V., Gubaidullin~I.M. Solution of the inverse problem of chemical kinetics on the example of benzylidenebenzylamine synthesis reaction // Journal of Middle Volga Mathematical Society. 2016. Vol.~18, No.~3. P.~145--152. (in Russian)

\bibitem{MorlanesLYMC2022}
Morlanes~N., Lezcano~G., Yerrayya~A., Mazumder~J., Castaño~P. Improving robustness of kinetic models for steam reforming based on artificial neural networks and ab initio calculations // Chemical Engineering Journal. 2022. Vol.~433. P.~133201.

\bibitem{PotemkinUGKSB2020}
Potemkin~D.I., Uskov~S.I., Gorlova~A.M., Kirillov~V.A., Shigarov~A.B., Brayko~A.S. et al. Low-temperature steam conversion of natural gas to methane--hydrogen mixtures // Catalysis in Industry. 2020. Vol.~12. P.~244--249.

\bibitem{ShigarovUP2022}
Shigarov~A.B., Uskov~S.I., Potemkin~D.I., Snytnikov~P.V. Experimental verification of kinetics and internal diffusion impact on low temperature steam reforming of a propane--methane mixture over Ni-based catalyst // Chemical Engineering Journal. 2022. Vol.~429. P.~132205.

\bibitem{Strongin2000}
Strongin~R.G., Sergeyev~Y.D. Global optimization with non-convex constraints. Sequential and parallel algorithms. Dordrecht: Kluwer Academic Publishers, 2000. 416~p.

\bibitem{UskovPSSKS2019}
Uskov~S.I., Potemkin~D.I., Shigarov~A.B., Snytnikov~P.V., Kirillov~V.A., Sobyanin~V.A. Low-temperature steam conversion of flare gases for various applications // Chemical Engineering Journal. 2019. Vol.~368. P.~533--540.

\bibitem{UrlukovUSSP2022}
Urlukov~A.S., Uskov~S.I., Sobyanin~V.A., Snytnikov~P.V., Potemkin~D.I. Ethane formation via catalytic low-temperature steam reforming of C$_{3+}$-alkanes // Chemical Engineering Journal. 2022. Vol.~446. P.~136993.

\bibitem{UrlukovUSPBRS2023}
Urlukov~A.S., Uskov~S.I., Potemkin~D.I., Berdyugin~S.N., Rogozhnikov~V.N., Snytnikov~P.V. Optimization of Rh-containing catalysts composition for low-temperature steam conversion of light hydrocarbons // Ecology and Industry of Russia. 2023. Vol.~27, No.~6. P.~17--23. (in Russian)

\bibitem{WooPBP2023}
Woo~Y., Park~J.M., Bae~J.W., Park~M.J. Kinetic modeling of the steam reforming of light hydrocarbon mixture from waste resources: Effects of gas composition on hydrogen production // International Journal of Hydrogen Energy. 2023. Vol.~48, No.~41. P.~15383--15391.

\bibitem{ZadesenetsGFSPP2023}
Zadesenets~A.V., Garkul~I.A., Filatov~E.Y., Sukhikh~A.S., Plusnin~P.E., Urlukov~A.S. et al. Double oxalates of Rh(III) with Ni(II) and Co(II)--Effective precursors of nanoalloys for hydrocarbons steam reforming // International Journal of Hydrogen Energy. 2023. Vol.~48, No.~59. P.~22428--22438.

\bibitem{ZyryanovaSSBKS2014}
Zyryanova~M.M., Snytnikov~P.V., Shigarov~A.B., Belyaev~V.D., Kirillov~V.A., Sobyanin~V.A. Kinetic features of methane steam reforming on nickel catalysts // Fuel. 2014. Vol.~135. P.~76--82.

\end{biblio_lat}
\end{document}
